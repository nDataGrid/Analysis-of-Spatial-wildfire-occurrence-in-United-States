---
title: "Assignment 3"
author: "Lokesh Bharule, 787425"
output:
  html_document:
    df_print: paged
---

This dataset is a dummy data created by IBM data scientists to uncover multiple factor which leads to employeeâ€™s attrition.  
This is the second dataset chosen from Assignment#1

Reference:
https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset


Loading of Libraries
```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)

```

Loading of Dataset
```{r}
emp_attrition <- read.csv("F:/RCodes/DAB501/WA_Fn-UseC_-HR-Employee-Attrition.csv")

```


**Exercise 1:**  
*Part 1 : Head of the Dataset*
```{r}
head(emp_attrition)
```

*Part 2: Tail of Dataset*
```{r}
tail(emp_attrition)
```

*Part 3: Summary of Dataset*
```{r}
summary(emp_attrition)
```
  
  
  
**Exercise 2:**  
*Question 1: How has work-life balance affected the attrition rate?*  
```{r message=FALSE, warning=FALSE}
work_bal_attr <- emp_attrition %>% select(Attrition, BusinessTravel, WorkLifeBalance) %>% 
  group_by(Attrition, BusinessTravel) %>% 
  summarize(count = n()) %>% 
  mutate(pct_attr = round(prop.table(count),2) * 100)
```


```{r message=FALSE, warning=FALSE}
plot1 <- ggplot(work_bal_attr, aes(x = Attrition, y = count, 
                          fill = BusinessTravel, color = Attrition)) +
  facet_wrap(~BusinessTravel) +
  geom_bar(stat='identity')
plot1
```
  
  
*Question 2: What are the top 5 job roles that has highest rate of attrition?*  
```{r message=FALSE, warning=FALSE}
job_role_attr <- emp_attrition %>% select(JobRole, Attrition) %>%
  group_by(JobRole, Attrition) %>% summarize(amount = n()) %>%
  mutate(pct_jr = round(prop.table(amount), 2) * 100) %>% arrange(pct_jr)
```


```{r message=FALSE, warning=FALSE}
job_role_attr1 <-
  job_role_attr %>% select(JobRole, Attrition, amount, pct_jr) %>%
  filter(Attrition == "Yes") %>% arrange(pct_jr)

#Learnt a new thing while performing slice()  
#slice will work with data.frame() and not with parameter  
job_role_attr5 <- slice(data.frame(job_role_attr1),-4:0)
job_role_attr5
```

  
*Question 3: Has the overtime in the company led to attrition?*  
```{r message=FALSE, warning=FALSE}
attr_ot <- emp_attrition %>% select(OverTime, Attrition) %>%
  filter(Attrition == "Yes") %>%
  group_by(Attrition, OverTime) %>%
  summarize(n = n()) %>% mutate(pct_ot = round(prop.table(n), 2) * 100)
```


```{r message=FALSE, warning=FALSE}
plot2 <- ggplot(attr_ot, aes(x = OverTime, y = pct_ot)) +
  geom_bar(stat = 'identity')
plot2

```



